<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buy Product</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="form-container">
    <h2>Delivery Address</h2>
    <form id="addressForm">
      <input type="text" placeholder="Name" required><br>
      <textarea placeholder="Address" required></textarea><br>
      <input type="text" placeholder="House no./Shop no." /><br>
      <input type="text" placeholder="Landmark" /><br>
      <input type="text" placeholder="City" required><br>
      <input type="text" placeholder="District" required><br>
      <input type="text" placeholder="State" required><br>
      <input type="text" placeholder="Pincode" required><br>
      <input type="text" placeholder="Phone" required><br>
      <button type="submit">Proceed to Pay</button>
    </form>
  </div>

  <script>
    const product = JSON.parse(localStorage.getItem("selectedProduct"));
    const form = document.getElementById("addressForm");

    form.onsubmit = (e) => {
      e.preventDefault();
      const data = [...form.elements].map(input => input.value);
      const address = `Name: ${data[0]}\nAddress: ${data[1]}\nHouse/Shop No: ${data[2]}\nLandmark: ${data[3]}\nCity: ${data[4]}\nDistrict: ${data[5]}\nState: ${data[6]}\nPincode: ${data[7]}\nPhone: ${data[8]}`;

      const upiUrl = `upi://pay?pa=hixzam313@okaxis&pn=GadgetCave&am=${product.price}&cu=INR&tn=Payment for ${product.name}`;
      window.location.href = upiUrl;

      setTimeout(() => {
        const msg = `*Order Placed*\n\n*Product:* ${product.name}\n*Amount:* â‚¹${product.price}\n\n*Address:*\n${address}`;
        const imageLink = product.image;
        const encoded = encodeURIComponent(`${msg}\n\nImage: ${imageLink}`);
        window.location.href = `https://wa.me/919744340057?text=${encoded}`;
      }, 4000);
    };
  </script>
</body>
</html>
